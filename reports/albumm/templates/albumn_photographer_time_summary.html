<title>Albumm business signups Time Reports</title>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<style>
 #dataTable thead tr, #dashboard thead tr, #dataTable1 thead tr, #dataTable2 thead tr{
	/* background-color: #EBEBEB; */
	background-color: white;
	font-size: 14px;
	font-family: Segoe UI Semibold;
}

.header{
  position: fixed;
  top:2px;
  background-color: black;
  width: 100%;
  height: 73px;
}

.img_pos{
  position: relative;
  top:20px;
  left:22px;
}

#dataTable thead tr th, #dataTable1 thead tr th, #dataTable2 thead tr th, #dashboard thead tr th {
	padding-bottom: 14px;
	border: none;
	padding-top: 15px;
	padding-left: 15px;
	color : rgba(0, 0, 0, 0.5);
}

#dataTable tbody tr, #dataTable1 tbody tr, #dataTable2 tbody tr, #dashboard tbody tr {
	counter-increment: rowNumber;
	/* background-color: #e6e4e4; */
	background-color: white;
	
}

#dataTable tbody tr td:first-child::before, #dataTable1 tbody tr td:first-child::before, #dataTable2 tbody tr td:first-child::before,  #dashboard tbody tr td:first-child::before
	{
	content: counter(rowNumber);
	min-width: 1em;
	margin-right: 0.5em;
	padding-left: 13px;
}

/* #dataTable tbody tr td:first-child, #dashboard tbody tr td:first-child {
	border-right: 1px solid #EBEBEB;
} */

#dataTable tbody tr td, #dataTable1 tbody tr td,#dataTable2 tbody tr td, #dashboard tbody tr td { 
	border-bottom: 2px solid #EBEBEB;
}

#dataTable tbody tr td, #dataTable1 tbody tr td, #dataTable2 tbody tr td, #dashboard tbody tr td {
	color: #000000;
	vertical-align: middle;
  text-align: center;
}
  #dataTable tbody, #dataTable2 tbody, #dataTable1 tbody, #dashboard tbody {
	font-size: 14px;
}

#dataTable tbody tr:nth-child(odd), #dataTable2 tbody tr:nth-child(odd), #dataTable1 tbody tr:nth-child(odd), #dashboard tbody tr:nth-child(odd) {
	/* background-color: #FFF; */
	background-color: white;
}

.upper_box{
	border: 1px solid #CCCCCC;
	width:9%;
	height: 69px;
	border-radius: 10px;
	position: absolute;
	top: 85px;
    right:30px;	
}

/* Style the tab */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Style the buttons inside the tab */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}

.tabcontent_ {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}

.tabcontent__ {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}

.number{
	text-align: center;
	font-family: Roboto;
}

</style>

<div class="header"> <img class="img_pos" src="https://d1q9zt8mabqinx.cloudfront.net/landing-page/home/logo/Spyne-White-Full-Logo.png" alt="spyne" width="140"> </img> </div> 

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css">

<h2 style="font-family: Roboto;font-size: 24px; margin-top: 6.5%;">Albumm Reprts (Merged) - By TIME</h2> <hr>

<div class="container" style="position: absolute; top:200px; width: 100%;">

	<div class="tab">
		<button class="tablinks_" onclick="onlyTabOpenFirst(event, 'Tabletop')">Table</button>
		<button class="tablinks_" onclick="onlyTabOpenFirst(event, 'Graphtop')">Graph</button>
  	</div>

  <div id="Tabletop" class="tabcontent_">

	<div class="tab">
		<button class="tablinks" onclick="opentimeZone(event, 'Daily')">Daily</button>
		<button class="tablinks" onclick="opentimeZone(event, 'Weekly')">Weekly</button>
		<button class="tablinks" onclick="opentimeZone(event, 'Monthly')">Monthly</button>
	  </div>


  
	  <div id="Daily" class="tabcontent">
		<div class="row">
			<div class="col-xs-12">
			  <div class="table-responsive" data-pattern="priority-columns">
				<table id="dataTable" class="table data-lead-table dataTable no-footer">
                    <thead>
                    <tr>
                      <th>No</th>
                      <th>Days</th>
                      <th>new Photographer</th>
                      <th>project shared</th>
                      <th>selection project</th>
                      <th>distribution project</th>
                      <th>photos shared</th>
                      <th>Multiple selection project</th>
                      <th>photos uploaded size</th>
                      <th>lead generated</th>
                      
                      <th>download count</th>
                      <th>review generated</th>
                      
                      <th>Average Lead</th>
                        </tr>
                        </thead>
                        <tbody>
                          {% for i1,i2,i3,i4,i5,i7,i8 in list1_list2_daily %}
                      <tr>
                        <td></td>
                            <td>{{i1['date']}}</td>
                        <td>{{ i1['new_photographer'] }}</td>
                        <td>{{i2['project_shared']}}</td>
                        <td>{{i2['selection_project']}}</td>
                        <td>{{i2['distribution_project']}}</td>
                        <td>{{i2['photo_shared']}}</td>
                        <td>{{i3['COUNT(DISTINCT ss.id)']}}</td>
                        <td> {{i7['SUM(vps.project_size)']}} </td>
                        <td> {{i8['count']}} </td>
                        
                        <td> {{i5['download_count']}} </td>
                        <td> {{i4['total_reviews']}} </td>
              
                        {% if i2['distribution_project'] == 0 %}
                        
                        <td> 0 </td>
                        {% else %}
                        
                        <td> {{(i8['count']/i2['distribution_project'])|round}} </td>
                        {% endif %}   
                        
                      </tr>
                          {% endfor %}
                
				  </tbody>
				</table>
			  </div>
			</div>
		  </div>
	  </div>


	  
	  <div id="Weekly" class="tabcontent">
		<div class="row">
			<div class="col-xs-12">
			  <div class="table-responsive" data-pattern="priority-columns">
				<table id="dataTable1" class="table data-lead-table dataTable no-footer">
                 
                <thead>
                    <tr>
                      <th>No</th>
                      <th>Week</th>
                    <th>new Photographer</th>
                      <th>project shared</th>
                      <th>selection project</th>
                      <th>distribution project</th>
                      <th>photos shared</th>
                      <th>Multiple selection project</th>
                      <th>photos uploaded size</th>
                      <th>lead generated</th>
                      <th>download count</th>
                      <th>review generated</th>
                      <th>Average Lead</th>
                        </tr>
                        </thead>
                        <tbody>
                          {% for i1,i2,i3,i4,i5,i7,i8 in list1_list2_weekly %}
                      <tr>
                        <td></td>
                        <td>{{i1['date']}}</td>
                        <td>{{ i1['new_photographer'] }}</td>
                        <td>{{i2['project_shared']}}</td>
                        <td>{{i2['selection_project']}}</td>
                        <td>{{i2['distribution_project']}}</td>
                        <td>{{i2['photo_shared']}}</td>
                        <td>{{i3['COUNT(DISTINCT ss.id)']}}</td>
                        <td> {{i7['SUM(vps.project_size)']}} </td>
                        <td> {{i8['count']}} </td>
                        <td> {{i5['download_count']}} </td>
                        <td> {{i4['total_reviews']}} </td>
                      
                        {% if i2['distribution_project'] == 0 %}
                        
                        <td> 0 </td>
                        {% else %}
                         
                        <td> {{(i8['count']/i2['distribution_project'])|round}} </td>
                        {% endif %}
              
              
                       
                      </tr>
                          {% endfor %}
                        </tbody>

				</table>
			  </div>
			</div>
		  </div>
	  </div>
	  
	  <div id="Monthly" class="tabcontent">
		<div class="row">
			<div class="col-xs-12">
			  <div class="table-responsive" data-pattern="priority-columns">
				<table id="dataTable2" class="table data-lead-table dataTable no-footer">
                
                
                    <thead>
                    <tr>
                    <th>No</th>
                    <th>Month	</th>
                    <th>new Photographer</th>
                    <th>project shared</th>
                    <th>selection project</th>
                    <th>distribution project</th>
                    <th>photos shared</th>
                    <th>Multiple selection project</th>
                    <th>photos uploaded size</th>
                    <th>lead generated</th>
            
                    <th>download count</th>
                    <th>review generated</th>
                    <th>Average Lead</th>
                      </tr>
                      </thead>
                      <tbody>
                        {% for i1,i2,i3,i4,i5,i7,i8 in list1_list2_monthly %}
                    <tr>
                      <td></td>
                      <td>{{i1['date']}}</td>
                      <td>{{ i1['new_photographer'] }}</td>
                      <td>{{i2['project_shared']}}</td>
                      <td>{{i2['selection_project']}}</td>
                      <td>{{i2['distribution_project']}}</td>
                      <td>{{i2['photo_shared']}}</td>
                      <td>{{i3['COUNT(DISTINCT ss.id)']}}</td>
                      <td> {{i7['SUM(vps.project_size)']}} </td>
                      <td> {{i8['count']}} </td>
                      <td> {{i5['download_count']}} </td>
                      <td> {{i4['total_reviews']}} </td>
                      
                      {% if i2['distribution_project'] == 0 %}
                      
                      <td> 0 </td>
                      {% else %}
                      
                      <td> {{(i8['count']/i2['distribution_project'])|round}} </td>
                      {% endif %}
            
                    </tr>
                        {% endfor %}
                      </tbody>


				</table>
			  </div>
			</div>
		  </div>
	  </div>

</div>
<div id="Graphtop" class="tabcontent_">

	<div class="tab">
		<button class="tablinks__" onclick="secondonlyTabOpen(event, 'DailyGraph')">Daily</button>
		<button class="tablinks__" onclick="secondonlyTabOpen(event, 'WeeklyGraph')">Weekly</button>
		<button class="tablinks__" onclick="secondonlyTabOpen(event, 'MonthlyGraph')">Monthly</button>
		
	  </div>

	<div id="DailyGraph" class="tabcontent__">
		<div id="chart1">
		</div>

		<br/> <br/> <br/>

		<div id="chart4">
		</div>

		
	</div>

	<div id="WeeklyGraph" class="tabcontent__">
		<div id="chart2">
		</div>

		<br/> <br/> <br/>

		<div id="chart5">
		</div>



		
	</div>


	<div id="MonthlyGraph" class="tabcontent__">
		<div id="chart3">
		</div>

		<br/> <br/> <br/>


		<div id="chart6">
		</div>
		
	</div>

</div>
</div>



<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>
<script>

var count=1

$(document).ready( function () {
    $('#dataTable').DataTable({
      "pagingType" : "simple_numbers",
				"bInfo" : false
    });

	$('#dataTable1').DataTable({
      "pagingType" : "simple_numbers",
				"bInfo" : false
    });

	$('#dataTable2').DataTable({
      "pagingType" : "simple_numbers",
				"bInfo" : false
    });

} );
</script>

<script>


function onlyTabOpenFirst(evt, timeZone){
		var i, tabcontent, tablinks;
		tabcontent = document.getElementsByClassName("tabcontent_");
	  	for (i = 0; i < tabcontent.length; i++) {
			tabcontent[i].style.display = "none";
	  	}
	  	tablinks = document.getElementsByClassName("tablinks_");
	  	for (i = 0; i < tablinks.length; i++) {
			tablinks[i].className = tablinks[i].className.replace(" active", "");
	  	}
	  	document.getElementById(timeZone).style.display = "block";
	  	evt.currentTarget.className += " active";


		if (timeZone=='Graphtop'){
			secondonlyTabOpen(event, 'DailyGraph');
		}

	}

	function onlyTabOpen(evt, timeZone){
		var i, tabcontent, tablinks;

		tabcontent = document.getElementsByClassName("tabcontent");
	  	for (i = 0; i < tabcontent.length; i++) {
			tabcontent[i].style.display = "none";
	  	}
	  	tablinks = document.getElementsByClassName("tablinks");
	  	for (i = 0; i < tablinks.length; i++) {
			tablinks[i].className = tablinks[i].className.replace(" active", "");
	  	}
	  	document.getElementById(timeZone).style.display = "block";
	  	evt.currentTarget.className += " active";

	}

	function secondonlyTabOpen(evt, timeZone){
		var i, tabcontent, tablinks;

		tabcontent = document.getElementsByClassName("tabcontent__");
	  	for (i = 0; i < tabcontent.length; i++) {
			tabcontent[i].style.display = "none";
	  	}
	  	tablinks = document.getElementsByClassName("tablinks__");
	  	for (i = 0; i < tablinks.length; i++) {
			tablinks[i].className = tablinks[i].className.replace(" active", "");
	  	}
	  	document.getElementById(timeZone).style.display = "block";
	  	evt.currentTarget.className += " active";
		

		if (timeZone=='DailyGraph'){
			var start = "daily(yyyy-mm-dd)";
		}
		else if (timeZone=="WeeklyGraph"){
			var start = "weekly(yyyy-week_no)";
		}

		else {
			var start = "monthly(yyyy-mm)";
		}

		var data={};
		data.start = start

		$.ajax({
		    type:'POST',
		    data: data,     
          	url: "http://127.0.0.1:5000/reports/albumm/albumm-reports-by-time",
          	success:function(resp) {
			myFunction(resp,start);  
			         
		},
		error : function(jqXHR,textStatus,errorThrown) {
			console.log('in error');
		}

	});

	}

	function opentimeZone(evt, timeZone) {
      
	  var filter=timeZone;
      var http = new XMLHttpRequest();
      http.open('GET',`/reports/albumm/albumm-reports-by-time?key=${filter}`)
      http.setRequestHeader("Content-type", "application/json; charset=utf-8");
      http.send();
	  window.location.replace(`/reports/albumm/albumm-reports-by-time?key=${timeZone}`)  
	
	}

	window.onload = function() {   
		if (window.location.href=="http://127.0.0.1:5000/reports/albumm/albumm-reports-by-time"){  
			onlyTabOpenFirst(event, 'Tabletop')
			onlyTabOpen(event, 'Daily')
		}
		else if (window.location.href=="http://127.0.0.1:5000/reports/albumm/albumm-reports-by-time?key=Monthly"){
			onlyTabOpenFirst(event, 'Tabletop')
			onlyTabOpen(event, 'Monthly')
		}
		else if (window.location.href=="http://127.0.0.1:5000/reports/albumm/albumm-reports-by-time?key=Weekly"){
			onlyTabOpenFirst(event, 'Tabletop')
			onlyTabOpen(event, 'Weekly')
		}
		
		else {
			onlyTabOpenFirst(event, 'Tabletop')
			onlyTabOpen(event, 'Daily')
		}
	
    };

	
</script>

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<script>
	function myFunction(resp,title_) {
		
		var y_axis = [];
		var x_axis = [];


		var y_axis_project_shared = [];
		var y_axis_selection_project = [];
		var y_axis_distribution_project = [];

		var i;

		for (i = 0; i < resp.length; i++) {
				y_axis.push(resp[i][4]);
				y_axis_project_shared.push(resp[i][1]);
				y_axis_selection_project.push(resp[i][2]);
				y_axis_distribution_project.push(resp[i][3]);
				x_axis.push(resp[i][0]);
		}			
		var options = {
          series: [{
            name: "No of Albumm Photos Shared",
            data: y_axis
        }],
          chart: {
          height: 360,
          type: 'line',
          zoom: {
            enabled: true
          }
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          curve: 'straight'
        },
        title: {
          text: 'No of Albumm Photos Shared vs Date',
          align: 'left'
        },
        grid: {
          row: {
            colors: ['#f3f3f3', 'transparent'], 
            opacity: 0.5
          },
        },
        xaxis: {
          categories: x_axis,
		  title: {
            text: title_
          }
        }
        };


		var options2 = {
          series: [
          {
            name: "Project shared",
            data: y_axis_project_shared
          },
          {
            name: "selection Project",
            data: y_axis_selection_project
          },
		  {
			name: "Distribution Project",
            data: y_axis_distribution_project
		  }
        ],
          chart: {
          height: 350,
          type: 'line',
          dropShadow: {
            enabled: true,
            color: '#000',
            top: 18,
            left: 7,
            blur: 10,
            opacity: 0.2
          },
          toolbar: {
            show: false
          }
        },
        colors: ['#77B6EA', '#545454', '#ff66cc'],
        dataLabels: {
			enabled: false
        },
        stroke: {
          curve: 'smooth'
        },
        title: {
          text: 'Albumm Graph vs Date',
          align: 'left'
        },
        grid: {
          borderColor: '#e7e7e7',
          row: {
            colors: ['#f3f3f3', 'transparent'], // takes an array which will be repeated on columns
            opacity: 0.5
          },
        },
        xaxis: {
          categories: x_axis,
          title: {
            text: title_
          }
        },
        legend: {
          position: 'top',
          horizontalAlign: 'right',
          floating: true,
          offsetY: -25,
          offsetX: -5
        }
        };

		if (title_=='daily(yyyy-mm-dd)'){
			var response_ = '#chart1';
			var chart = new ApexCharts(document.querySelector(response_), options);
        	chart.render();

			var response__ = '#chart4';
			var chart4 = new ApexCharts(document.querySelector(response__), options2);
        	chart4.render();


		}
		else if (title_=="weekly(yyyy-week_no)"){
			var response_ = '#chart2';
			var chart = new ApexCharts(document.querySelector(response_), options);
        	chart.render();

			var response__ = '#chart5';
			var chart5 = new ApexCharts(document.querySelector(response__), options2);
        	chart5.render();

		}

		else {
			var response_ = '#chart3';
			var chart = new ApexCharts(document.querySelector(response_), options);
        	chart.render();

			var response__ = '#chart6';
			var chart6 = new ApexCharts(document.querySelector(response__), options2);
        	chart6.render();


		}
	}


</script>
